// SPDX-License-Identifier: LGPL-2.1-or-later OR LicenseRef-SCE-Commercial
// SPDX-FileCopyrightText: Copyright (c) 2025 newmassrael

/**
 * W3C SCXML Test List
 *
 * ⚠️ AUTO-GENERATED - DO NOT EDIT MANUALLY
 * Source: tests/CMakeLists.txt - W3C_AOT_TESTS
 * Generator: tools/generate_test_list.py
 *
 * Zero Duplication: This file is automatically generated from CMakeLists.txt.
 * To update the test list, modify tests/CMakeLists.txt and run:
 *     python3 tools/generate_test_list.py
 * Or rebuild with CMake (automatic generation via custom command).
 */

const W3C_TEST_LIST = [
    144, 147, 148, 149, 150, 151, 152, 153, 155, 156, 158, 159, 172, 173, 174, 175, 176, 178, 179, 183, 185, 186, 187, 189, 190, 191, 192, 193, 194, 198, 199,
    200, 205, 207, 208, 210, 215, 216, 220, 223, 224, 225, 226, 228, 229, 230, 232, 233, 234, 235, 236, 237, 239, 240, 241, 242, 243, 244, 245, 247, 250, 276, 277, 278, 279, 280, 286, 287, 294, 298,
    301, 302, 303, 304, 307, 309, 310, 311, 312, 313, 314, 318, 319, 321, 322, 323, 324, 325, 326, 329, 330, 331, 332, 333, 335, 336, 337, 338, 339, 342, 343, 344, 346, 347, 348, 349, 350, 351, 352, 354, 355, 364, 372, 375, 376, 377, 378, 387, 388, 396, 399,
    401, 402, '403a', '403b', '403c', 404, 405, 406, 407, 409, 411, 412, 413, 415, 416, 417, 419, 421, 422, 423, 436, 444, 445, 446, 448, 449, 451, 452, 453, 456, 457, 459, 460, 487, 488, 495, 496,
    500, 501, 503, 504, 505, 506, 521, 525, 527, 528, 529, 530, 533, 550, 551, 552, 553, 554, 557, 558, 560, 561, 562, 569, 570, 576, 578, 579, 580,
    252, 253
];

/**
 * Get current test number from URL hash
 */
function getCurrentTestNumber() {
    const params = {};
    const hash = window.location.hash.substring(1);

    hash.split('&').forEach(param => {
        const [key, value] = param.split('=');
        if (key && value) {
            params[key] = decodeURIComponent(value);
        }
    });

    return params.test;
}

/**
 * Navigate to test by number
 */
function navigateToTest(testNumber) {
    window.location.hash = `test=${testNumber}`;
    window.location.reload();
}

/**
 * Get previous test number
 */
function getPreviousTest() {
    const currentTest = getCurrentTestNumber();
    if (!currentTest) return null;

    const currentIndex = W3C_TEST_LIST.indexOf(currentTest);
    if (currentIndex === -1) {
        const currentNum = parseInt(currentTest);
        const numIndex = W3C_TEST_LIST.indexOf(currentNum);
        if (numIndex > 0) {
            return W3C_TEST_LIST[numIndex - 1];
        }
        return null;
    }

    if (currentIndex > 0) {
        return W3C_TEST_LIST[currentIndex - 1];
    }

    return null;
}

/**
 * Get next test number
 */
function getNextTest() {
    const currentTest = getCurrentTestNumber();
    if (!currentTest) return null;

    const currentIndex = W3C_TEST_LIST.indexOf(currentTest);
    if (currentIndex === -1) {
        const currentNum = parseInt(currentTest);
        const numIndex = W3C_TEST_LIST.indexOf(currentNum);
        if (numIndex >= 0 && numIndex < W3C_TEST_LIST.length - 1) {
            return W3C_TEST_LIST[numIndex + 1];
        }
        return null;
    }

    if (currentIndex < W3C_TEST_LIST.length - 1) {
        return W3C_TEST_LIST[currentIndex + 1];
    }

    return null;
}

/**
 * Initialize test navigation buttons
 */
function initializeTestNavigation() {
    const btnPrevTest = document.getElementById('btn-prev-test');
    const btnNextTest = document.getElementById('btn-next-test');

    if (btnPrevTest) {
        const prevTest = getPreviousTest();
        if (prevTest) {
            btnPrevTest.disabled = false;
            btnPrevTest.addEventListener('click', () => {
                navigateToTest(prevTest);
            });
        } else {
            btnPrevTest.disabled = true;
        }
    }

    if (btnNextTest) {
        const nextTest = getNextTest();
        if (nextTest) {
            btnNextTest.disabled = false;
            btnNextTest.addEventListener('click', () => {
                navigateToTest(nextTest);
            });
        } else {
            btnNextTest.disabled = true;
        }
    }

    console.log(`[Test Navigation] Current: ${getCurrentTestNumber()}, Prev: ${getPreviousTest()}, Next: ${getNextTest()}`);
}

// Initialize on DOMContentLoaded
window.addEventListener('DOMContentLoaded', initializeTestNavigation);
